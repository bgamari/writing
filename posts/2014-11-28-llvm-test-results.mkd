---
title: GHC and LLVM: Tests
date: 2014-11-28
tags: ghc, llvm, arm
description: Results from compatbility tests between LLVM and GHC.
---

# GHC-LLVM compatibility tests

Here are results from a series of compatibility tests of GHC's LLVM
backend.  See the
[main article](/posts/2014-11-28-state-of-llvm-backend.html) for
conclusions.

These were taken on an x86-64 EC2 instance running Ubuntu
14.04.1 LTS.

## LLVM 3.5, GHC 7.8.3 with rework, internal symbols

```
Unexpected results from:
TEST="T7571 T8256"

OVERALL SUMMARY for test run started at Fri Nov 28 21:14:53 2014 UTC
 0:00:47 spent to go through
    3953 total tests, which gave rise to
   21343 test cases, of which
   19720 were skipped

      27 had missing libraries
    1577 expected passes
      17 expected failures

       0 caused framework failures
       0 unexpected passes
       2 unexpected failures

Unexpected failures:
   codeGen/should_run   T8256 [exit code non-0] (llvm)
   llvm/should_compile  T7571 [stderr mismatch] (llvm)
```


## LLVM 3.4, GHC 7.8.3 with rework, internal symbols

Everything is broken,

```
/tmp/ghc98211_0/ghc98211_6.s: Assembler messages:

/tmp/ghc98211_0/ghc98211_6.s:87:0:
     Error: can't resolve `.rodata' {.rodata section} - `Main_main_info$def' {.text section}

/tmp/ghc98211_0/ghc98211_6.s:108:0:
     Error: can't resolve `.rodata' {.rodata section} - `ZCMain_main_info$def' {.text section}
```


## LLVM 3.3, GHC 7.8.3 with rework, internal symbols

```
Unexpected results from:
TEST="T7571 T8256"

OVERALL SUMMARY for test run started at Fri Nov 28 21:43:10 2014 UTC
 0:00:46 spent to go through
    3953 total tests, which gave rise to
   21343 test cases, of which
   19720 were skipped

      27 had missing libraries
    1577 expected passes
      17 expected failures

       0 caused framework failures
       0 unexpected passes
       2 unexpected failures

Unexpected failures:
   codeGen/should_run   T8256 [exit code non-0] (llvm)
   llvm/should_compile  T7571 [stderr mismatch] (llvm)

```

## LLVM 3.2, GHC 7.8.3 with rework, internal symbols

```
Unexpected results from:
TEST="T7571 T8256"

OVERALL SUMMARY for test run started at Fri Nov 28 21:44:33 2014 UTC
 0:00:46 spent to go through
    3953 total tests, which gave rise to
   21343 test cases, of which
   19720 were skipped

      27 had missing libraries
    1577 expected passes
      17 expected failures

       0 caused framework failures
       0 unexpected passes
       2 unexpected failures

Unexpected failures:
   codeGen/should_run   T8256 [exit code non-0] (llvm)
   llvm/should_compile  T7571 [stderr mismatch] (llvm)

```


## LLVM 3.5, GHC 7.8.3 with rework, external symbols

```
Unexpected results from:
TEST="T7571 T8256 T5313 dynCompileExpr"

OVERALL SUMMARY for test run started at Fri Nov 28 21:35:10 2014 UTC
 0:00:46 spent to go through
    3953 total tests, which gave rise to
   21343 test cases, of which
   19720 were skipped

      27 had missing libraries
    1575 expected passes
      17 expected failures

       0 caused framework failures
       0 unexpected passes
       4 unexpected failures

Unexpected failures:
   codeGen/should_run      T8256 [exit code non-0] (llvm)
   driver                  T5313 [exit code non-0] (llvm)
   ghc-api/dynCompileExpr  dynCompileExpr [exit code non-0] (llvm)
   llvm/should_compile     T7571 [stderr mismatch] (llvm)
```


## LLVM 3.4, GHC 7.8.3 with rework, external symbols

```
Unexpected results from:
TEST="T7571 T8256 T5313 dynCompileExpr"

OVERALL SUMMARY for test run started at Fri Nov 28 21:30:30 2014 UTC
 0:00:46 spent to go through
    3953 total tests, which gave rise to
   21343 test cases, of which
   19720 were skipped

      27 had missing libraries
    1575 expected passes
      17 expected failures

       0 caused framework failures
       0 unexpected passes
       4 unexpected failures

Unexpected failures:
   codeGen/should_run      T8256 [exit code non-0] (llvm)
   driver                  T5313 [exit code non-0] (llvm)
   ghc-api/dynCompileExpr  dynCompileExpr [exit code non-0] (llvm)
   llvm/should_compile     T7571 [stderr mismatch] (llvm)
```


## LLVM 3.3, GHC 7.8.4 with rework, external symbols

```
Unexpected results from:
TEST="T7571 T8256 T5313 dynCompileExpr"

OVERALL SUMMARY for test run started at Fri Nov 28 21:32:31 2014 UTC
 0:00:45 spent to go through
    3953 total tests, which gave rise to
   21343 test cases, of which
   19720 were skipped

      27 had missing libraries
    1575 expected passes
      17 expected failures

       0 caused framework failures
       0 unexpected passes
       4 unexpected failures

Unexpected failures:
   codeGen/should_run      T8256 [exit code non-0] (llvm)
   driver                  T5313 [exit code non-0] (llvm)
   ghc-api/dynCompileExpr  dynCompileExpr [exit code non-0] (llvm)
   llvm/should_compile     T7571 [stderr mismatch] (llvm)
```


## LLVM 3.2, GHC 7.8.4 with rework, external symbols

```
Unexpected results from:
TEST="T7571 T8256 T5313 dynCompileExpr"

OVERALL SUMMARY for test run started at Fri Nov 28 21:33:52 2014 UTC
 0:00:46 spent to go through
    3953 total tests, which gave rise to
   21343 test cases, of which
   19720 were skipped

      27 had missing libraries
    1575 expected passes
      17 expected failures

       0 caused framework failures
       0 unexpected passes
       4 unexpected failures

Unexpected failures:
   codeGen/should_run      T8256 [exit code non-0] (llvm)
   driver                  T5313 [exit code non-0] (llvm)
   ghc-api/dynCompileExpr  dynCompileExpr [exit code non-0] (llvm)
   llvm/should_compile     T7571 [stderr mismatch] (llvm)
```

## GHC 7.9, llvm-3.6 branch, LLVM 3.6 on ARM

GHC commit `a7c29721535d636fb16ab756b3f44224e04a5113` with my
`llvm-3.6` branch. Running against llvm `r222923` with my `prefix` and
`ghc-tcreturn` branches.

```
Unexpected results from:
TEST="Flags02 literals prof-doc-fib recomp009 linker_unload dynHelloWorld T703 T7574 ghci053 T4491 print025 print021 print020 print022 T8557 T7386 print018 T7064 plugins05 T7918 ghcirun002 ghcirun001 ghcirun004 Conversions T9203 T5549 T5321FD T5030 T4801 T5631 T5837 T5642 T3064 T1969 T5321Fun T783 haddock.Cabal haddock.compiler haddock.base space_leak_001"

OVERALL SUMMARY for test run started at Sat Nov 29 07:31:20 2014 CET
 0:33:38 spent to go through
    4229 total tests, which gave rise to
   17514 test cases, of which
   13713 were skipped

      56 had missing libraries
    3666 expected passes
      39 expected failures

       3 caused framework failures
       0 unexpected passes
      23 unexpected failures
      17 unexpected stat failures

Unexpected failures:
   codeGen/should_compile        T7574 [stderr mismatch] (normal)
   driver                        T703 [bad exit code] (normal)
   driver                        dynHelloWorld [bad stdout] (dyn)
   driver/recomp009              recomp009 [bad exit code] (normal)
   ghc-api/annotations-literals  literals [bad exit code] (normal)
   ghci.debugger/scripts         T7386 [bad exit code] (ghci)
   ghci.debugger/scripts         T8557 [bad exit code] (ghci)
   ghci.debugger/scripts         print018 [bad exit code] (ghci)
   ghci.debugger/scripts         print020 [bad exit code] (ghci)
   ghci.debugger/scripts         print021 [bad exit code] (ghci)
   ghci.debugger/scripts         print022 [bad exit code] (ghci)
   ghci.debugger/scripts         print025 [bad exit code] (ghci)
   ghci/scripts                  ghci053 [bad exit code] (ghci)
   ghci/should_run               ghcirun001 [bad exit code] (ghci)
   ghci/should_run               ghcirun002 [bad exit code] (ghci)
   ghci/should_run               ghcirun004 [bad stdout or stderr] (ghci)
   plugins                       plugins05 [bad stdout] (dyn)
   profiling/should_run          prof-doc-fib [bad profile] (profasm)
   quasiquotation                T7918 [bad exit code] (dyn)
   quasiquotation/T4491          T4491 [bad exit code] (dyn)
   rts                           linker_unload [bad exit code] (normal)
   safeHaskell/flags             Flags02 [exit code non-0] (normal)
   th                            T7064 [bad exit code] (normal)

Unexpected stat failures:
   perf/compiler     T1969 [stat not good enough] (normal)
   perf/compiler     T3064 [stat not good enough] (normal)
   perf/compiler     T4801 [stat not good enough] (normal)
   perf/compiler     T5030 [stat not good enough] (normal)
   perf/compiler     T5321FD [stat not good enough] (normal)
   perf/compiler     T5321Fun [stat not good enough] (normal)
   perf/compiler     T5631 [stat not good enough] (normal)
   perf/compiler     T5642 [stat not good enough] (normal)
   perf/compiler     T5837 [stat not good enough] (normal)
   perf/compiler     T783 [stat not good enough] (normal)
   perf/haddock      haddock.Cabal [stat not good enough] (normal)
   perf/haddock      haddock.base [stat not good enough] (normal)
   perf/haddock      haddock.compiler [stat not good enough] (normal)
   perf/should_run   Conversions [stat not good enough] (normal)
   perf/should_run   T5549 [stat not good enough] (normal)
   perf/should_run   T9203 [stat not good enough] (normal)
   perf/space_leaks  space_leak_001 [stat not good enough] (normal)
```
